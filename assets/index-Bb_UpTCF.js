(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();const k="https://api.quran.com/api/v4";let H=7,E=85,p=[],d=0,o=!1,f=[],S=[],M=[];const v=document.getElementById("first-10"),g=document.getElementById("last-10"),y=document.getElementById("full-surah"),n=document.getElementById("audioPlayer"),C=document.getElementById("playBtn"),V=document.getElementById("progressBar"),_=document.getElementById("timeDisplay"),D=document.getElementById("reciterSelect"),K=document.getElementById("translationSelect"),b=document.getElementById("hadith-container"),$=document.querySelectorAll(".tab-btn"),A=[{text:"Whoever memorizes ten verses from the beginning of Surat al-Kahf will be protected from the Dajjal.",source:"Sahih Muslim 809"},{text:"Whoever reads Surat al-Kahf on Friday, he will be illuminated with light between the two Fridays.",source:"Al-Mustadrak 2/399 (Al-Hakim)"},{text:"Whoever recites Surat al-Kahf as it was revealed, it will be a light for him on the Day of Resurrection.",source:"Al-Sunan al-Kubra 5856 (Al-Nasa'i)"},{text:"One who memorizes the first ten verses of Surah Kahf will be secure against the Dajjal.",source:"Sahih Muslim 809"},{text:"Whoever reads the last ten verses of Surat al-Kahf, if the Dajjal emerges, he will not be harmed by him.",source:"Al-Sunan al-Kubra 10732"}];document.addEventListener("DOMContentLoaded",()=>{q(),x(),N()});function q(){T(),setInterval(T,1e4)}function T(){const t=Math.floor(Math.random()*A.length),e=A[t];b.style.opacity="0",setTimeout(()=>{b.innerHTML=`
            <p class="hadith-text">"${e.text}"</p>
            <span class="hadith-source">â€” ${e.source}</span>
        `,b.style.opacity="1"},500)}async function x(){v.innerHTML='<div class="loading">Loading verses...</div>',g.innerHTML='<div class="loading">Loading verses...</div>',y.innerHTML='<div class="loading">Loading verses...</div>';try{f=await w(1,10),L(f,v),S=await w(101,110),L(S,g),M=await w(1,110),L(M,y),m(f)}catch(t){console.error("Error loading verses:",t),v.innerHTML='<div class="error">Failed to load verses. Please try again.</div>',g.innerHTML='<div class="error">Failed to load verses. Please try again.</div>',y.innerHTML='<div class="error">Failed to load verses. Please try again.</div>'}}async function w(t,e){const a=e-t+1,s=Math.floor((t-1)/a)+1,r=`${k}/verses/by_chapter/18?language=en&translations=${E},57&audio=${H}&per_page=${a}&page=${s}&fields=text_uthmani,chapter_id`,i=await fetch(r);if(!i.ok)throw new Error("Network response was not ok");return(await i.json()).verses.map(l=>{const I=l.translations?.filter(c=>c.resource_id!==57),O=((I?.find(c=>c.resource_id==E)||I?.[0])?.text||"Translation unavailable").replace(/<[^>]*>/g,""),j=(l.translations?.find(c=>c.resource_id==57)?.text||"").replace(/<[^>]*>/g,"");return{id:l.id,key:l.verse_key,number:l.verse_number,text:l.text_uthmani,translation:O,transliteration:j,audioUrl:l.audio?.url}})}function L(t,e){e.innerHTML="",t.forEach(a=>{const s=document.createElement("div");s.className="verse-card",s.id=`verse-${a.key.replace(":","-")}`,s.innerHTML=`
            <div class="verse-header">
                <span class="verse-number">Ayah ${a.number}</span>
                <button class="play-verse-btn" onclick="playSingleVerse('${a.key}')">
                    <svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
                </button>
            </div>
            <div class="arabic-text">${a.text}</div>
            <div class="transliteration">${a.transliteration}</div>
            <div class="translation">${a.translation}</div>
        `,e.appendChild(s)})}function N(){$.forEach(t=>{t.addEventListener("click",()=>{$.forEach(a=>a.classList.remove("active")),document.querySelectorAll(".verses-container").forEach(a=>a.classList.remove("active")),t.classList.add("active");const e=t.getAttribute("data-target");document.getElementById(e).classList.add("active"),e==="first-10"?m(f):e==="last-10"?m(S):e==="full-surah"&&m(M),P()})}),C.addEventListener("click",z),n.addEventListener("timeupdate",W),n.addEventListener("ended",U),D.addEventListener("change",t=>{H={"ar.alafasy":7,"ar.abdulbasit":1,"ar.sudais":3,"ar.husary":4}[t.target.value],o&&P(),x()}),K.addEventListener("change",t=>{E={"en.sahih":85,"en.yusufali":22,"en.pickthall":19}[t.target.value]||85,x()})}function m(t){p=t,d=0}function z(){o?(n.pause(),o=!1,u()):F()}function F(){!n.src||n.ended?B(d):(n.play(),o=!0,u())}function B(t){if(t>=p.length){o=!1,u();return}const e=p[t];document.querySelectorAll(".verse-card").forEach(s=>s.style.borderColor="transparent");const a=document.getElementById(`verse-${e.key.replace(":","-")}`);if(a&&(a.style.borderColor="var(--accent-gold)",a.scrollIntoView({behavior:"smooth",block:"center"})),e.audioUrl){const s=e.audioUrl.startsWith("http")?e.audioUrl:`https://verses.quran.com/${e.audioUrl}`;n.src=s,n.play(),o=!0,u()}}function U(){d++,B(d)}function P(){n.pause(),n.currentTime=0,o=!1,u()}function u(){C.innerHTML=o?'<svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>':'<svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>'}function W(){if(n.duration){const t=n.currentTime/n.duration*100;V.style.width=`${t}%`;const e=Math.floor(n.currentTime/60),a=Math.floor(n.currentTime%60),s=Math.floor(n.duration/60),r=Math.floor(n.duration%60);_.textContent=`${e}:${a.toString().padStart(2,"0")} / ${s}:${r.toString().padStart(2,"0")}`}}window.playSingleVerse=t=>{const e=p.findIndex(a=>a.key===t);e!==-1?(d=e,B(e)):console.warn("Verse not found in current queue")};
