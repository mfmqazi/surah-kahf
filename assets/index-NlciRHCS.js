(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();const O="https://api.quran.com/api/v4";let T=7,L=85,m=[],d=0,o=!1,h=[],E=[],S=[];const p=document.getElementById("first-10"),v=document.getElementById("last-10"),g=document.getElementById("full-surah"),s=document.getElementById("audioPlayer"),H=document.getElementById("playBtn"),j=document.getElementById("progressBar"),k=document.getElementById("timeDisplay"),V=document.getElementById("reciterSelect"),_=document.getElementById("translationSelect"),y=document.getElementById("hadith-container"),B=document.querySelectorAll(".tab-btn"),I=[{text:"Whoever memorizes ten verses from the beginning of Surat al-Kahf will be protected from the Dajjal.",source:"Sahih Muslim 809"},{text:"Whoever reads Surat al-Kahf on Friday, he will be illuminated with light between the two Fridays.",source:"Al-Mustadrak 2/399 (Al-Hakim)"},{text:"Whoever recites Surat al-Kahf as it was revealed, it will be a light for him on the Day of Resurrection.",source:"Al-Sunan al-Kubra 5856 (Al-Nasa'i)"},{text:"One who memorizes the first ten verses of Surah Kahf will be secure against the Dajjal.",source:"Sahih Muslim 809"},{text:"Whoever reads the last ten verses of Surat al-Kahf, if the Dajjal emerges, he will not be harmed by him.",source:"Al-Sunan al-Kubra 10732"}];document.addEventListener("DOMContentLoaded",()=>{D(),M(),K()});function D(){$(),setInterval($,1e4)}function $(){const t=Math.floor(Math.random()*I.length),e=I[t];y.style.opacity="0",setTimeout(()=>{y.innerHTML=`
            <p class="hadith-text">"${e.text}"</p>
            <span class="hadith-source">â€” ${e.source}</span>
        `,y.style.opacity="1"},500)}async function M(){p.innerHTML='<div class="loading">Loading verses...</div>',v.innerHTML='<div class="loading">Loading verses...</div>',g.innerHTML='<div class="loading">Loading verses...</div>';try{h=await b(1,10),w(h,p),E=await b(101,110),w(E,v),S=await b(1,110),w(S,g),f(h)}catch(t){console.error("Error loading verses:",t),p.innerHTML='<div class="error">Failed to load verses. Please try again.</div>',v.innerHTML='<div class="error">Failed to load verses. Please try again.</div>',g.innerHTML='<div class="error">Failed to load verses. Please try again.</div>'}}async function b(t,e){const a=`${O}/verses/by_chapter/18?language=en&translations=${L},57&audio=${T}&page=1&per_page=${e-t+1}&offset=${t-1}&fields=text_uthmani,chapter_id`,i=await fetch(a);if(!i.ok)throw new Error("Network response was not ok");return(await i.json()).verses.map(r=>{const l=r.translations?.filter(c=>c.resource_id!==57),P=((l?.find(c=>c.resource_id==L)||l?.[0])?.text||"Translation unavailable").replace(/<[^>]*>/g,""),C=(r.translations?.find(c=>c.resource_id==57)?.text||"").replace(/<[^>]*>/g,"");return{id:r.id,key:r.verse_key,number:r.verse_number,text:r.text_uthmani,translation:P,transliteration:C,audioUrl:r.audio?.url}})}function w(t,e){e.innerHTML="",t.forEach(a=>{const i=document.createElement("div");i.className="verse-card",i.id=`verse-${a.key.replace(":","-")}`,i.innerHTML=`
            <div class="verse-header">
                <span class="verse-number">Ayah ${a.number}</span>
                <button class="play-verse-btn" onclick="playSingleVerse('${a.key}')">
                    <svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
                </button>
            </div>
            <div class="arabic-text">${a.text}</div>
            <div class="transliteration">${a.transliteration}</div>
            <div class="translation">${a.translation}</div>
        `,e.appendChild(i)})}function K(){B.forEach(t=>{t.addEventListener("click",()=>{B.forEach(a=>a.classList.remove("active")),document.querySelectorAll(".verses-container").forEach(a=>a.classList.remove("active")),t.classList.add("active");const e=t.getAttribute("data-target");document.getElementById(e).classList.add("active"),e==="first-10"?f(h):e==="last-10"?f(E):e==="full-surah"&&f(S),A()})}),H.addEventListener("click",q),s.addEventListener("timeupdate",F),s.addEventListener("ended",z),V.addEventListener("change",t=>{T={"ar.alafasy":7,"ar.abdulbasit":1,"ar.sudais":3,"ar.husary":4}[t.target.value],o&&A(),M()}),_.addEventListener("change",t=>{L={"en.sahih":85,"en.yusufali":22,"en.pickthall":19}[t.target.value]||85,M()})}function f(t){m=t,d=0}function q(){o?(s.pause(),o=!1,u()):N()}function N(){!s.src||s.ended?x(d):(s.play(),o=!0,u())}function x(t){if(t>=m.length){o=!1,u();return}const e=m[t];document.querySelectorAll(".verse-card").forEach(i=>i.style.borderColor="transparent");const a=document.getElementById(`verse-${e.key.replace(":","-")}`);if(a&&(a.style.borderColor="var(--accent-gold)",a.scrollIntoView({behavior:"smooth",block:"center"})),e.audioUrl){const i=e.audioUrl.startsWith("http")?e.audioUrl:`https://verses.quran.com/${e.audioUrl}`;s.src=i,s.play(),o=!0,u()}}function z(){d++,x(d)}function A(){s.pause(),s.currentTime=0,o=!1,u()}function u(){H.innerHTML=o?'<svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>':'<svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>'}function F(){if(s.duration){const t=s.currentTime/s.duration*100;j.style.width=`${t}%`;const e=Math.floor(s.currentTime/60),a=Math.floor(s.currentTime%60),i=Math.floor(s.duration/60),n=Math.floor(s.duration%60);k.textContent=`${e}:${a.toString().padStart(2,"0")} / ${i}:${n.toString().padStart(2,"0")}`}}window.playSingleVerse=t=>{const e=m.findIndex(a=>a.key===t);e!==-1?(d=e,x(e)):console.warn("Verse not found in current queue")};
