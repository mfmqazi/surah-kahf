(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();const C="https://api.quran.com/api/v4";let T=7,L=85,m=[],d=0,o=!1,h=[],M=[],E=[];const p=document.getElementById("first-10"),v=document.getElementById("last-10"),y=document.getElementById("full-surah"),s=document.getElementById("audioPlayer"),k=document.getElementById("playBtn"),O=document.getElementById("progressBar"),j=document.getElementById("timeDisplay"),V=document.getElementById("reciterSelect"),D=document.getElementById("translationSelect"),g=document.getElementById("hadith-container"),B=document.querySelectorAll(".tab-btn"),I=[{text:"Whoever memorizes ten verses from the beginning of Surat al-Kahf will be protected from the Dajjal.",source:"Sahih Muslim 809"},{text:"Whoever reads Surat al-Kahf on Friday, he will be illuminated with light between the two Fridays.",source:"Al-Mustadrak 2/399 (Al-Hakim)"},{text:"Whoever recites Surat al-Kahf as it was revealed, it will be a light for him on the Day of Resurrection.",source:"Al-Sunan al-Kubra 5856 (Al-Nasa'i)"},{text:"One who memorizes the first ten verses of Surah Kahf will be secure against the Dajjal.",source:"Sahih Muslim 809"},{text:"Whoever reads the last ten verses of Surat al-Kahf, if the Dajjal emerges, he will not be harmed by him.",source:"Al-Sunan al-Kubra 10732"}];document.addEventListener("DOMContentLoaded",()=>{K(),S(),q()});function K(){$(),setInterval($,1e4)}function $(){const t=Math.floor(Math.random()*I.length),e=I[t];g.style.opacity="0",setTimeout(()=>{g.innerHTML=`
            <p class="hadith-text">"${e.text}"</p>
            <span class="hadith-source">â€” ${e.source}</span>
        `,g.style.opacity="1"},500)}async function S(){p.innerHTML='<div class="loading">Loading verses...</div>',v.innerHTML='<div class="loading">Loading verses...</div>',y.innerHTML='<div class="loading">Loading verses...</div>';try{h=await b(1,10),w(h,p),M=await b(101,110),w(M,v),E=await b(1,110),w(E,y),f(h)}catch(t){console.error("Error loading verses:",t),p.innerHTML='<div class="error">Failed to load verses. Please try again.</div>',v.innerHTML='<div class="error">Failed to load verses. Please try again.</div>',y.innerHTML='<div class="error">Failed to load verses. Please try again.</div>'}}async function b(t,e){const r=`${C}/verses/by_chapter/18?language=en&translations=${L},57&audio=${T}&words=true&per_page=${e-t+1}&offset=${t-1}&fields=text_uthmani,chapter_id`,i=await fetch(r);if(!i.ok)throw new Error("Network response was not ok");return(await i.json()).verses.map(a=>{const c=a.translations?.filter(l=>l.resource_id!==57),H=((c?.find(l=>l.resource_id==L)||c?.[0])?.text||"Translation unavailable").replace(/<[^>]*>/g,""),P=(a.translations?.find(l=>l.resource_id==57)?.text||"").replace(/<[^>]*>/g,""),_=a.words?.find(l=>l.char_type_name==="end")?.text_uthmani||"";return{id:a.id,key:a.verse_key,number:a.verse_number,text:a.text_uthmani,translation:H,transliteration:P,audioUrl:a.audio?.url,verseMarker:_}})}function w(t,e){e.innerHTML="",t.forEach(r=>{const i=document.createElement("div");i.className="verse-card",i.id=`verse-${r.key.replace(":","-")}`,i.innerHTML=`
            <div class="verse-header">
                <span class="verse-number">Ayah ${r.number}</span>
                <button class="play-verse-btn" onclick="playSingleVerse('${r.key}')">
                    <svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
                </button>
            </div>
            <div class="arabic-text">${r.text} <span class="verse-marker">${r.verseMarker}</span></div>
            <div class="transliteration">${r.transliteration}</div>
            <div class="translation">${r.translation}</div>
        `,e.appendChild(i)})}function q(){B.forEach(t=>{t.addEventListener("click",()=>{B.forEach(r=>r.classList.remove("active")),document.querySelectorAll(".verses-container").forEach(r=>r.classList.remove("active")),t.classList.add("active");const e=t.getAttribute("data-target");document.getElementById(e).classList.add("active"),e==="first-10"?f(h):e==="last-10"?f(M):e==="full-surah"&&f(E),A()})}),k.addEventListener("click",N),s.addEventListener("timeupdate",U),s.addEventListener("ended",F),V.addEventListener("change",t=>{T={"ar.alafasy":7,"ar.abdulbasit":1,"ar.sudais":3,"ar.husary":4}[t.target.value],o&&A(),S()}),D.addEventListener("change",t=>{L={"en.sahih":85,"en.yusufali":22,"en.pickthall":19}[t.target.value]||85,S()})}function f(t){m=t,d=0}function N(){o?(s.pause(),o=!1,u()):z()}function z(){!s.src||s.ended?x(d):(s.play(),o=!0,u())}function x(t){if(t>=m.length){o=!1,u();return}const e=m[t];document.querySelectorAll(".verse-card").forEach(i=>i.style.borderColor="transparent");const r=document.getElementById(`verse-${e.key.replace(":","-")}`);if(r&&(r.style.borderColor="var(--accent-gold)",r.scrollIntoView({behavior:"smooth",block:"center"})),e.audioUrl){const i=e.audioUrl.startsWith("http")?e.audioUrl:`https://verses.quran.com/${e.audioUrl}`;s.src=i,s.play(),o=!0,u()}}function F(){d++,x(d)}function A(){s.pause(),s.currentTime=0,o=!1,u()}function u(){k.innerHTML=o?'<svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>':'<svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>'}function U(){if(s.duration){const t=s.currentTime/s.duration*100;O.style.width=`${t}%`;const e=Math.floor(s.currentTime/60),r=Math.floor(s.currentTime%60),i=Math.floor(s.duration/60),n=Math.floor(s.duration%60);j.textContent=`${e}:${r.toString().padStart(2,"0")} / ${i}:${n.toString().padStart(2,"0")}`}}window.playSingleVerse=t=>{const e=m.findIndex(r=>r.key===t);e!==-1?(d=e,x(e)):console.warn("Verse not found in current queue")};
